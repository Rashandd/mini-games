{% extends "base.html" %}

{% block title %}Leaderboard {{ '‚Äî ' + game.name if game else '' }}{% endblock %}

{% block head %}
<meta name="description" content="Top players ranked by ELO rating."/>
<style>
    .lb-container { max-width: 800px; width: 100%; }
    .lb-tabs { display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap; }
    .lb-tab {
        padding: 8px 16px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;
        background: var(--bg-glass); border: 1px solid var(--border-glass);
        color: var(--text-secondary); cursor: pointer; text-decoration: none;
        transition: var(--transition-fast);
    }
    .lb-tab:hover, .lb-tab.active {
        background: var(--accent-primary); color: white; border-color: var(--accent-primary);
    }
    .lb-table { width: 100%; border-collapse: collapse; }
    .lb-table th {
        text-align: left; font-size: 0.7rem; font-weight: 600; color: var(--text-muted);
        text-transform: uppercase; letter-spacing: 0.5px; padding: 8px 12px;
        border-bottom: 1px solid var(--border-glass);
    }
    .lb-table td {
        padding: 10px 12px; font-size: 0.85rem; border-bottom: 1px solid rgba(255,255,255,0.04);
    }
    .lb-table tr:hover td { background: rgba(108,99,255,0.05); }
    .rank-badge {
        display: inline-flex; align-items: center; justify-content: center;
        width: 28px; height: 28px; border-radius: 50%; font-weight: 800; font-size: 0.75rem;
    }
    .rank-1 { background: linear-gradient(135deg, #ffd700, #ffaa00); color: #333; }
    .rank-2 { background: linear-gradient(135deg, #c0c0c0, #a0a0a0); color: #333; }
    .rank-3 { background: linear-gradient(135deg, #cd7f32, #a0522d); color: white; }
    .rank-default { background: var(--bg-glass); color: var(--text-secondary); }
    .rating-pill {
        padding: 3px 10px; border-radius: 12px; font-weight: 700; font-size: 0.78rem;
        background: rgba(108,99,255,0.15); color: var(--accent-primary);
    }
    .wr-bar { display: inline-block; height: 6px; border-radius: 3px; background: var(--accent-green); }
    .stats-row { display: flex; gap: 16px; color: var(--text-muted); font-size: 0.75rem; }
    .empty-state {
        text-align: center; padding: 48px; color: var(--text-muted); font-size: 0.9rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-container" style="padding-top: 24px;">
    <div class="lb-container">
        <div class="home-header">
            <h1>üèÜ Leaderboard</h1>
            <div class="home-nav">
                <a href="/home" class="btn btn-secondary btn-sm">‚Üê Games</a>
            </div>
        </div>

        <!-- Tabs -->
        <div class="lb-tabs">
            <a href="/leaderboard" class="lb-tab {{ 'active' if not game else '' }}">üåç Global</a>
            {% for g in all_games %}
            <a href="/leaderboard/{{ g.slug }}" class="lb-tab {{ 'active' if game and game.slug == g.slug else '' }}">
                {{ g.icon }} {{ g.name }}
            </a>
            {% endfor %}
        </div>

        <!-- Table -->
        <div class="glass-card" style="padding: 0; overflow: auto;">
            {% if entries %}
            <table class="lb-table">
                <thead>
                    <tr>
                        <th style="width:50px;">Rank</th>
                        <th>Player</th>
                        {% if game %}
                        <th>Rating</th>
                        <th>W / L / D</th>
                        <th>Win Rate</th>
                        {% else %}
                        <th>Score</th>
                        <th>W / L / D</th>
                        <th>Avg Rating</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% for e in entries %}
                    <tr>
                        <td>
                            <span class="rank-badge {% if e.rank == 1 %}rank-1{% elif e.rank == 2 %}rank-2{% elif e.rank == 3 %}rank-3{% else %}rank-default{% endif %}">
                                {{ e.rank }}
                            </span>
                        </td>
                        <td><strong>{{ e.username }}</strong></td>
                        {% if game %}
                        <td><span class="rating-pill">{{ e.rating }}</span></td>
                        <td>{{ e.wins }} / {{ e.losses }} / {{ e.draws }}</td>
                        <td>
                            <div class="wr-bar" style="width: {{ e.win_rate }}%;"></div>
                            {{ e.win_rate }}%
                        </td>
                        {% else %}
                        <td><span class="rating-pill">{{ e.total_score }}</span></td>
                        <td>{{ e.total_wins }} / {{ e.total_losses }} / {{ e.total_draws }}</td>
                        <td><span class="rating-pill">{{ e.avg_rating }}</span></td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <div class="empty-state">
                <p>üéÆ No rankings yet. Play some games to get on the board!</p>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="page-footer mt-24"><p>Mini Games Platform</p></div>
</div>
{% endblock %}
